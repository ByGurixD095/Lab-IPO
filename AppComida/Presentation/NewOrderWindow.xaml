<Window x:Class="AppComida.Presentation.NewOrderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Nuevo Pedido" Height="700" Width="1100"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None" ResizeMode="NoResize"
        AllowsTransparency="True" Background="Transparent">

    <Border Background="{DynamicResource MainBg}" CornerRadius="12" BorderBrush="{DynamicResource BrandColor}" BorderThickness="1">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2.5*"/>
                <!-- CATÁLOGO -->
                <ColumnDefinition Width="1.5*"/>
                <!-- TICKET -->
            </Grid.ColumnDefinitions>

            <!-- ================= IZQUIERDA: CATÁLOGO ================= -->
            <Grid Grid.Column="0" Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Título -->
                <TextBlock Text="Seleccionar Productos" FontSize="22" FontWeight="Bold" Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,15"/>

                <!-- Pestañas de Categoría (Se llenan por código) -->
                <TabControl x:Name="TabsMenu" Grid.Row="1" Background="Transparent" BorderThickness="0">
                    <TabControl.Resources>
                        <Style TargetType="TabItem">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TabItem">
                                        <Border x:Name="bd" Background="Transparent" CornerRadius="20" Padding="15,8" Margin="0,0,10,10" BorderThickness="1" BorderBrush="#E0E0E0">
                                            <ContentPresenter ContentSource="Header" TextElement.FontWeight="SemiBold"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="bd" Property="Background" Value="{DynamicResource BrandColor}"/>
                                                <Setter TargetName="bd" Property="BorderBrush" Value="{DynamicResource BrandColor}"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="False">
                                                <Setter Property="Foreground" Value="{DynamicResource TextSecondary}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabControl.Resources>
                </TabControl>
            </Grid>

            <!-- ================= DERECHA: TICKET ================= -->
            <Border Grid.Column="1" Background="White" CornerRadius="0,12,12,0" BorderBrush="#E0E0E0" BorderThickness="1,0,0,0">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Header Ticket -->
                        <RowDefinition Height="*"/>
                        <!-- Lista Items -->
                        <RowDefinition Height="Auto"/>
                        <!-- Datos Pedido -->
                        <RowDefinition Height="Auto"/>
                        <!-- Total y Botones -->
                    </Grid.RowDefinitions>

                    <StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Style="{StaticResource BtnCloseStyle}" Click="BtnCancel_Click"/>
                        </StackPanel>
                        <TextBlock Text="Resumen del Pedido" FontSize="18" FontWeight="Bold" Foreground="{DynamicResource TextPrimary}" Margin="0,-30,0,20" Width="174"/>
                    </StackPanel>

                    <!-- Lista de Items en el Carrito -->
                    <ListBox x:Name="LstCart" Grid.Row="1" BorderThickness="0" Background="Transparent" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel>
                                        <TextBlock Text="{Binding Name}" FontWeight="SemiBold" TextWrapping="Wrap"/>
                                        <TextBlock Text="{Binding Price, StringFormat='{}{0:C}'}" FontSize="12" Foreground="{DynamicResource TextSecondary}"/>
                                    </StackPanel>

                                    <!-- Botón Eliminar Item -->
                                    <Button Grid.Column="2" Content="X" Foreground="Red" Background="Transparent" BorderThickness="0" 
                                            Margin="10,0,0,0" FontWeight="Bold" Cursor="Hand" Click="BtnRemoveItem_Click" Tag="{Binding}"/>
                                </Grid>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>

                    <!-- Formulario Datos -->
                    <StackPanel Grid.Row="2" Margin="0,15">
                        <TextBlock Text="CLIENTE" FontSize="10" FontWeight="Bold" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,5"/>
                        <ComboBox x:Name="CmbClientes" Height="35" Margin="0,0,0,10" DisplayMemberPath="NombreCompleto"/>

                        <TextBlock Text="TIPO ENTREGA" FontSize="10" FontWeight="Bold" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,5"/>
                        <ComboBox x:Name="CmbEntrega" Height="35">
                            <ComboBoxItem Content="Mesa 1"/>
                            <ComboBoxItem Content="Mesa 2"/>
                            <ComboBoxItem Content="Mesa 3"/>
                            <ComboBoxItem Content="Mesa 4"/>
                            <ComboBoxItem Content="Domicilio"/>
                            <ComboBoxItem Content="Recoger"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Footer -->
                    <StackPanel Grid.Row="3">
                        <Border BorderThickness="0,1,0,0" BorderBrush="#E0E0E0" Margin="0,10"/>
                        <DockPanel LastChildFill="False">
                            <TextBlock Text="TOTAL" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                            <TextBlock x:Name="TxtTotal" Text="0,00 €" FontSize="24" FontWeight="Bold" Foreground="{DynamicResource BrandColor}" DockPanel.Dock="Right"/>
                        </DockPanel>

                        <Button Content="Confirmar Pedido" Style="{StaticResource BtnPrimaryStyle}" Margin="0,20,0,0" Click="BtnConfirm_Click"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>